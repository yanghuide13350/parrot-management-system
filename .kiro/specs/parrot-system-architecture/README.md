# 鹦鹉管理系统架构规划

## 文档概览

本规划包含以下文档:

1. **requirements.md** - 完整的业务需求文档

   - 15 个核心需求
   - 每个需求包含用户故事和验收标准
   - 遵循 EARS 语法规范

2. **system-overview.md** - 系统架构概览

   - 技术栈和架构模式
   - 数据库设计
   - 前端页面结构
   - 页面间数据流转关系
   - API 接口映射
   - 销售与退货的关键区别
   - 组件复用关系
   - 状态管理策略

3. **data-flow-diagrams.md** - 数据流程图
   - 销售与退货完整流程图
   - 数据表关系图
   - 页面导航流程图
   - 状态转换图
   - API 调用时序图
   - 时间线数据整合流程

## 核心要点总结

### 销售与退货的数据设计

系统采用**双表设计**:

- **Parrot 表**: 存储鹦鹉的**当前状态**和**当前销售信息**
- **SalesHistory 表**: 存储鹦鹉的**所有历史销售记录**

### 关键业务流程

1. **首次销售**: Parrot 表记录销售信息,status=sold
2. **回访**: 创建 FollowUp 记录,更新回访状态
3. **退货**:
   - 当前销售信息复制到 SalesHistory 表
   - Parrot 表销售字段清空,status=available
4. **再次销售**: Parrot 表重新记录新的销售信息

### 页面职责划分

- **销售记录页面**: 显示**当前在售**的鹦鹉 (Parrot 表,status=sold)
- **退货管理页面**: 显示**历史退货**记录 (SalesHistory 表,return_date 不为空)
- **时间线页面**: 整合 Parrot 表+SalesHistory 表+FollowUp 表,展示完整生命周期

## 下一步计划

完成需求梳理后,可以进行:

1. 设计文档编写 (design.md)
2. 任务分解 (tasks.md)
3. 功能实现和优化
