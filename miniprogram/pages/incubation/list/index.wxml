<view class="page">
  <view class="filter-bar">
    <view class="filter-item" bindtap="toggleFilter">
      <text class="filter-text">ç­›é€‰</text>
      <text class="filter-icon">â–¼</text>
    </view>
    <view class="quick-filters">
      <view class="quick-filter-item" bindtap="resetFilter">å…¨éƒ¨</view>
    </view>
  </view>

  <view class="filter-drawer {{showFilter ? 'show' : ''}}">
    <view class="filter-content">
      <view class="filter-group">
        <view class="filter-label">çŠ¶æ€</view>
        <picker mode="selector" range="{{statusList}}" range-key="label" value="0" bindchange="onStatusChange">
          <view class="filter-value">{{statusLabel}}</view>
        </picker>
      </view>

      <view class="filter-group">
        <view class="filter-label">å¼€å§‹æ—¥æœŸä»</view>
        <picker mode="date" bindchange="onStartDateFromChange">
          <view class="filter-value">{{filters.startDateFrom || 'è¯·é€‰æ‹©'}}</view>
        </picker>
      </view>

      <view class="filter-group">
        <view class="filter-label">å¼€å§‹æ—¥æœŸåˆ°</view>
        <picker mode="date" bindchange="onStartDateToChange">
          <view class="filter-value">{{filters.startDateTo || 'è¯·é€‰æ‹©'}}</view>
        </picker>
      </view>

      <view class="filter-group">
        <view class="filter-label">æœç´¢</view>
        <input class="filter-input" placeholder="æœç´¢çˆ¶æ¯é¸Ÿåœˆå·" value="{{filters.search}}" bindinput="onSearchInput" />
      </view>

      <view class="filter-actions">
        <button class="filter-btn reset" bindtap="resetFilter">é‡ç½®</button>
        <button class="filter-btn apply" bindtap="applyFilter">åº”ç”¨</button>
      </view>
    </view>
  </view>

  <view class="list">
    <view class="incubation-card glass-card" wx:for="{{list}}" wx:key="id">
      <view class="card-header">
        <view class="status-badge status-{{item.status}}">{{item.statusText}}</view>
        <view class="start-date">{{item.startDateText}}</view>
        <view class="incubation-days" wx:if="{{item.incubationDays}}">{{item.incubationDays}}</view>
      </view>
      <view class="card-body">
        <view class="parents">
          <view class="parent-item">
            <text class="parent-label">çˆ¶:</text>
            <text class="parent-value">{{item.father ? (item.father.ring_number || item.father.breed) : 'æœªçŸ¥'}}</text>
          </view>
          <view class="parent-item">
            <text class="parent-label">æ¯:</text>
            <text class="parent-value">{{item.mother ? (item.mother.ring_number || item.mother.breed) : 'æœªçŸ¥'}}</text>
          </view>
        </view>
        <view class="eggs-info">
          <text class="eggs-count">{{item.eggs_count}}æšè›‹</text>
          <text class="hatched-count">å·²å­µåŒ– {{item.hatched_count}}åª</text>
          <text class="hatch-rate" wx:if="{{item.hatchRate}}">å­µåŒ–ç‡ {{item.hatchRate}}</text>
        </view>
      </view>
      <view class="card-footer" wx:if="{{item.status === 'incubating'}}">
        <button class="update-btn" data-id="{{item.id}}" bindtap="goEdit">æ›´æ–°</button>
      </view>
    </view>

    <empty-state wx:if="{{!list.length && !loading}}" icon="ğŸ¥š" text="æš‚æ— å­µåŒ–è®°å½•" />
  </view>

  <view class="fab" bindtap="goAdd">
    <text class="fab-icon">+</text>
  </view>
</view>
