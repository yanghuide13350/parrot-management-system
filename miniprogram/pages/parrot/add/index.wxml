<view class="page">
  <view class="form-card glass-card">
    <view class="form-item">
      <text class="form-label"><text class="required">*</text> 品种</text>
      <view class="breed-input-wrapper">
        <input
          class="breed-input {{showBreedList && filteredBreeds.length ? 'has-list' : ''}}"
          placeholder="请输入或选择品种"
          data-field="breed"
          bindinput="onBreedInput"
          value="{{form.breed}}"
          bindfocus="onBreedFocus"
          bindblur="onBreedBlur"
        />
        <view class="breed-list {{showBreedList && filteredBreeds.length ? 'show' : ''}}">
          <view
            class="breed-item"
            wx:for="{{filteredBreeds}}"
            wx:key="*this"
            data-value="{{item}}"
            bindtap="selectBreed"
          >{{item}}</view>
        </view>
      </view>
    </view>

    <view class="form-item">
      <text class="form-label"><text class="required">*</text> 圈号</text>
      <input placeholder="请输入圈号" data-field="ring_number" bindinput="onInput" value="{{form.ring_number}}" />
    </view>

    <view class="form-item">
      <text class="form-label"><text class="required">*</text> 性别</text>
      <picker mode="selector" range="{{genders}}" bindchange="onGenderChange">
        <view class="picker-value {{genderIndex < 0 ? 'placeholder' : ''}}">
          {{genderIndex >= 0 ? genders[genderIndex] : '请选择性别'}}
        </view>
      </picker>
    </view>

    <view class="form-item">
      <text class="form-label"><text class="required">*</text> 出生日期</text>
      <picker mode="date" bindchange="onDateChange">
        <view class="picker-value {{form.birth_date ? '' : 'placeholder'}}">
          {{form.birth_date || '请选择日期'}}
        </view>
      </picker>
    </view>

    <view class="form-item">
      <text class="form-label"><text class="required">*</text> 价格</text>
      <input type="digit" placeholder="请输入价格" data-field="price" bindinput="onInput" value="{{form.price}}" />
    </view>

    <view class="form-item">
      <text class="form-label">健康备注</text>
      <textarea placeholder="请输入备注" data-field="health_notes" bindinput="onInput" value="{{form.health_notes}}" />
    </view>
  </view>
  
  <view class="photo-section">
    <text class="form-label">照片/视频</text>
    <view class="photo-grid">
      <view class="photo-item" wx:for="{{photos}}" wx:key="path">
        <block wx:if="{{item.isVideo}}">
          <video src="{{item.path}}" mode="aspectFill" />
          <view class="video-play-icon">
            <view class="play-btn"></view>
          </view>
        </block>
        <block wx:else>
          <image src="{{item.path}}" mode="aspectFill" />
        </block>
        <view class="photo-remove" data-index="{{index}}" bindtap="removePhoto">×</view>
      </view>
      <view class="photo-add" bindtap="choosePhoto" wx:if="{{photos.length < 9}}">
        <text>+</text>
        <text>添加照片/视频</text>
      </view>
    </view>
  </view>
  
  <view class="submit-bar">
    <button bindtap="submit" disabled="{{submitting}}">{{submitting ? '提交中...' : '保存'}}</button>
  </view>
</view>
