<view class="page">
  <view class="filter-bar">
    <view class="filter-item" bindtap="toggleFilter">
      <text class="filter-text">ç­›é€‰</text>
      <text class="filter-icon">â–¼</text>
    </view>
    <view class="quick-filters">
      <view class="quick-filter-item" bindtap="resetFilter">å…¨éƒ¨</view>
    </view>
  </view>

  <view class="filter-drawer {{showFilter ? 'show' : ''}}">
    <view class="filter-content">
      <view class="filter-group">
        <view class="filter-label">é…å¯¹çŠ¶æ€</view>
        <picker mode="selector" range="{{pairingStatusList}}" range-key="label" value="0" bindchange="onPairingStatusChange">
          <view class="filter-value">{{pairingStatusLabel}}</view>
        </picker>
      </view>

      <view class="filter-group">
        <view class="filter-label">å“ç§</view>
        <picker mode="selector" range="{{breedList}}" range-key="label" value="0" bindchange="onBreedChange">
          <view class="filter-value">{{breedLabel}}</view>
        </picker>
      </view>

      <view class="filter-group">
        <view class="filter-label">æ€§åˆ«</view>
        <picker mode="selector" range="{{genderList}}" range-key="label" value="0" bindchange="onGenderChange">
          <view class="filter-value">{{genderLabel}}</view>
        </picker>
      </view>

      <view class="filter-group">
        <view class="filter-label">æœç´¢</view>
        <input class="filter-input" placeholder="æœç´¢åœˆå·æˆ–å“ç§" value="{{filters.search}}" bindinput="onSearchInput" />
      </view>

      <view class="filter-actions">
        <button class="filter-btn reset" bindtap="resetFilter">é‡ç½®</button>
        <button class="filter-btn apply" bindtap="applyFilter">åº”ç”¨</button>
      </view>
    </view>
  </view>

  <view class="list">
    <view
      class="breeding-card status-{{item.status}}"
      wx:for="{{list}}"
      wx:key="id"
      data-id="{{item.id}}"
      bindtap="goDetail"
    >
      <view class="status-tag status-{{item.status}}">
        <text>{{item.status === 'breeding' ? 'â—' : item.status === 'paired' ? 'â™¥' : 'ğŸ£'}}</text>
        <text>{{item.statusText}}</text>
      </view>
      <view class="card-left">
        <view class="breed">{{item.breed}}</view>
        <view class="meta">{{item.gender}} Â· {{item.ring_number || 'æ— åœˆå·'}}</view>
        <view class="mate-info" wx:if="{{item.mateInfo}}">
          <text class="mate-icon">â™¥</text>
          <text class="mate-text">{{item.mateInfo.breed}} ({{item.mateInfo.ring_number || 'æ— åœˆå·'}})</text>
          <text class="mate-duration">{{item.pairingDuration}}</text>
        </view>
      </view>
      <view class="card-right">
        <view class="action-buttons">
          <button
            wx:if="{{item.status === 'breeding' && item.gender === 'å…¬'}}"
            class="action-btn pair"
            catchtap="goPair"
            data-id="{{item.id}}"
          >é…å¯¹</button>
          <button
            wx:if="{{item.status === 'breeding' && item.gender === 'æ¯'}}"
            class="action-btn pair"
            catchtap="goPair"
            data-id="{{item.id}}"
          >é…å¯¹</button>
          <button
            wx:if="{{item.status === 'paired'}}"
            class="action-btn unpair"
            catchtap="unpairParrot"
            data-id="{{item.id}}"
          >å–æ¶ˆé…å¯¹</button>
          <button
            wx:if="{{item.status === 'paired'}}"
            class="action-btn incubation"
            catchtap="goIncubation"
            data-id="{{item.id}}"
          >å¼€å§‹å­µåŒ–</button>
          <button
            wx:if="{{item.status === 'incubating'}}"
            class="action-btn view-incubation"
            catchtap="goIncubationList"
          >æŸ¥çœ‹å­µåŒ–</button>
        </view>
      </view>
    </view>

    <view class="empty-state" wx:if="{{!list.length && !loading}}">
      <text class="empty-text">æš‚æ— ç§é¸Ÿ</text>
    </view>
  </view>
</view>
